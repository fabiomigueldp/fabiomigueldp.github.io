<!DOCTYPE html>
<html lang="la">
<head>
  <meta charset="UTF-8">
  <title>OPUS MAGNUM DIGITALIS - THEOSIS</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Mate+SC&family=Marcellus+SC&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Paleta da Luz Absoluta & Criação */
      --kenoma-profundum: #000000; /* Vazio Abissal, o Não-Ser que é Potencial */
      --scintilla-prima: #FFFFFF; /* O Ponto Incriado, pura atualidade */
      --lux-increata-effulgentia: rgba(255, 255, 255, 0.95); /* Emanação primária, ofuscante */
      --lumen-divinum-aurum: #FFDF00; /* Luz dourada da Divindade, Graça */
      --lumen-sapientiae-sapphirus: #0D1B82; /* Luz azul-safira da Sabedoria Divina */
      --lumen-amoris-ignis: #FF2400; /* Luz vermelho-rubi/fogo do Amor Divino */
      --lumen-seraphicum-flamma: #FFA500; /* Laranja flamejante para Serafins */
      --lumen-cherubicum-caeruleum: #7AB8DB; /* Azul cerúleo para Querubins */
      --lumen-thronorum-crystallus: #E0FFFF; /* Cristal/ciano claro para Tronos */
      --vestigia-dei-amethystus: #A069E3; /* Traços de Deus, mistério e realeza */
      --anima-cosmica-smaragdus: #3EDC81; /* Verde esmeralda para a Alma do Mundo, Vida */
      --pleroma-alba-margarita: #FFF8DC; /* Branco pérola para a Plenitude, totalidade */
      --reditus-viola-obscura: #320336; /* Violeta escuro para o retorno místico */
    }

    /* Reset e Fundamentos Canônicos */
    html, body {
      width: 100%; height: 100%; margin: 0; padding: 0;
      overflow: hidden; background-color: var(--kenoma-profundum);
      font-family: 'Cormorant Garamond', 'Libre Baskerville', serif; /* Fontes nobres e legíveis */
      opacity: 0;
      animation: aperturaAdSacrum 7s ease-out forwards; animation-delay: 2.5s;
    }
    @keyframes aperturaAdSacrum { 0% { opacity:0; } 100% { opacity: 1; } }

    /* O Teatro da Teofania */
    #theosis-theatrum {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      perspective: 3500px; /* Profundidade abissal da visão */
      perspective-origin: 50% 50%;
      z-index: 1;
      transform-style: preserve-3d; /* Essencial para camadas */
      animation: spiritusMundiRespiratio 60s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite alternate;
    }
    @keyframes spiritusMundiRespiratio { /* A respiração sutil do universo */
      0% { transform: scale(1.000); filter: brightness(0.98); }
      100% { transform: scale(1.003); filter: brightness(1.02); }
    }
    #background-aether-canvas { /* Camada mais profunda para éter sutil */
        position: fixed; top:0; left:0; width:100%; height:100%; z-index: -5; pointer-events:none;
    }


    /* Botão da Visão Plena (Overengineered com Glória) */
    #visio-plena-thronus {
      position: fixed; bottom: 35px; right: 35px;
      padding: 18px 30px; border-radius: 7px;
      background: radial-gradient(ellipse at center, rgba(255,223,0,0.05) 0%, rgba(0,0,0,0.5) 100%),
                  linear-gradient(160deg, rgba(255,210,0,0.15) 0%, rgba(170,50,0,0.25) 100%);
      color: var(--lumen-divinum-aurum); border: 2px solid;
      border-image-source: linear-gradient(160deg, var(--lumen-divinum-aurum), var(--lumen-amoris-ignis));
      border-image-slice: 1;
      font-family: 'Marcellus SC', 'Mate SC', serif; font-size: 17px; text-transform: uppercase; letter-spacing: 1.5px;
      cursor: pointer; opacity: 0.85;
      text-shadow: 0 0 5px var(--lumen-divinum-aurum), 0 0 10px var(--lumen-amoris-ignis);
      box-shadow: 0 0 10px rgba(255,223,0,0.1), 0 0 20px rgba(255,100,0,0.1),
                  inset 0 0 8px rgba(255,255,255,0.03), inset 0 0 15px rgba(255,223,0,0.05);
      transition: all 0.6s cubic-bezier(0.075, 0.82, 0.165, 1);
      z-index: 100001; transform: translateZ(50px); /* Leve elevação */
    }
    #visio-plena-thronus:hover, #visio-plena-thronus:focus {
      opacity: 1; transform: scale(1.05) translateY(-3px) translateZ(60px) rotateX(-2deg);
      box-shadow: 0 8px 30px rgba(255,223,0,0.3), 0 5px 20px rgba(255,100,0,0.3),
                  inset 0 0 10px rgba(255,255,255,0.05), inset 0 0 20px rgba(255,223,0,0.08);
      border-image-source: linear-gradient(160deg, var(--lumen-amoris-ignis), var(--lumen-divinum-aurum)); /* Inverte gradiente da borda */
      text-shadow: 0 0 8px var(--lumen-divinum-aurum), 0 0 15px var(--lumen-amoris-ignis), 0 0 25px var(--scintilla-prima);
    }
    body:fullscreen #visio-plena-thronus, body:-webkit-full-screen #visio-plena-thronus { display: none; }


    /* O Ponto Primordial Incriado */
    #principium-incognitum { /* Antiga Scintilla Divina */
      position: absolute; top: 50%; left: 50%; width: 0.5px; height: 0.5px; /* Quase infinitesimal */
      border-radius: 50%; background-color: var(--scintilla-prima);
      opacity: 0; transform: translate3d(-50%, -50%, -1000px) scale(0.0001); /* Começa de uma profundidade imensa */
      z-index: 5000; filter: brightness(1); /* Controle de brilho máximo */
      /* Sombra controlada por JS/WAAPI para timing perfeito e intensidade máxima */
    }

    /* LUX INCEREATA - PRIMEIRA EMANAÇÃO */
    .lux-prima-unda { /* Onda da Luz Primordial */
      position: absolute; border-radius: 50%;
      border: 0.25px solid var(--lux-increata-effulgentia); /* Finíssima, pura luz */
      opacity: 0; pointer-events: none; z-index: 1000;
      filter: blur(0.25px) brightness(2.0); /* Brilho intenso e pureza */
      mix-blend-mode: screen; /* Para sobreposição luminosa */
    }
    
    /* IGNIS DIVINUS - FAGULHAS DIVINAS REFINADAS */
    .ignis-divinus-scintilla {
        position: absolute; border-radius: 50%;
        opacity: 0; pointer-events: none; z-index: 1500;
        /* background e box-shadow por JS para máxima variação e performance */
    }
    .ignis-trail-segment { /* Segmentos da cauda da fagulha */
        position: absolute; width: 100%; height: 100%; border-radius: 50%;
        opacity: 0; transform-origin: center center;
         /* background por JS, combinando com a fagulha */
    }


    /* LUMEN CREATUM - SEGUNDA EMANAÇÃO (Hierarquias e Formas) */
    .angelorum-chorus-particula {
      position: absolute; border-radius: 50%;
      opacity: 0; pointer-events: none; z-index: 500;
      transform-style: preserve-3d; /* Para aninhar auras e trilhas complexas */
    }
    .particula-aura-divina { /* Aura luminosa multicamada para cada partícula angélica */
        position: absolute; top:50%; left:50%; width: 1px; height:1px; /* Será escalada */
        border-radius: 50%; opacity: 0;
    }
    .particula-cometa-cauda { /* Cauda de luz dinâmica e multicamada */
      position: absolute; top: 50%; left: 50%;
      height: 1px; /* Linha base para a cauda */
      opacity: 0; transform-origin: 0% 50%;
      transform-style: preserve-3d; /* Para camadas na cauda */
    }
    .cauda-stratum { /* Camada individual da cauda da partícula */
        position:absolute; width:100%; height:100%;
        transform-origin: 0% 50%; border-radius: 0 50% 50% 0; /* Forma de gota/cometa */
    }


    .sophia-nebula-majestas { /* Nebulosa da Sabedoria com majestade */
      position: absolute; opacity: 0;
      pointer-events: none; z-index: 100;
      transform-style: preserve-3d; /* Para efeitos de profundidade e camadas internas */
      mix-blend-mode: add; /* Para superaquecimento luminoso ao se cruzar */
      animation: nebulaReginaSaltatio 300s cubic-bezier(0.42, 0, 0.58, 1) infinite alternate, /* Dança Real das Nebulosas */
                 nebulaFormaTransfiguratio 220s ease-in-out infinite alternate;
    }
    /* Gradientes internos e animações de background para movimento intrínseco */
    @keyframes nebulaReginaSaltatio { /* Dança mais majestosa e complexa */
      0%   { transform: translate3d(-50%, -50%, 0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(0.95); filter: saturate(0.9) brightness(0.95); }
      25%  { transform: translate3d(-50%, -50%, 100px) rotateX(15deg) rotateY(-10deg) rotateZ(20deg) scale(1); filter: saturate(1.1) brightness(1.05); }
      50%  { transform: translate3d(-50%, -50%, -50px) rotateX(-5deg) rotateY(20deg) rotateZ(-15deg) scale(1.05); filter: saturate(1) brightness(1); }
      75%  { transform: translate3d(-50%, -50%, 50px) rotateX(10deg) rotateY(-15deg) rotateZ(5deg) scale(0.98); filter: saturate(1.2) brightness(1.1); }
      100% { transform: translate3d(-50%, -50%, 0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg) scale(0.95); filter: saturate(0.9) brightness(0.95); }
    }
    @keyframes nebulaFormaTransfiguratio { /* Transfiguração constante da forma */
      0%   { border-radius: 35% 65% 70% 30% / 30% 60% 40% 70%; }
      33%  { border-radius: 70% 30% 50% 50% / 60% 30% 70% 40%; }
      66%  { border-radius: 50% 50% 30% 70% / 40% 70% 30% 60%; }
      100% { border-radius: 35% 65% 70% 30% / 30% 60% 40% 70%; }
    }


    .gratia-flumen-magnum { /* Grande Rio da Graça */
      position: absolute; height: 2px; opacity: 0;
      pointer-events: none; z-index: 200;
      transform-style: preserve-3d;
      filter: blur(0.8px) drop-shadow(0 0 6px var(--lumen-divinum-aurum)) drop-shadow(0 0 12px var(--pleroma-alba-margarita));
    }
    .flumen-particula-undae { /* Partículas de 'água viva' no rio */
        position:absolute; width: 2px; height: 2px; border-radius:50%;
        /* Animado por JS ao longo do 'offsetPath' do rio principal */
    }

    /* O LOGOS DIVINO – PALAVRA CRIADORA Onipotente */
    #logos-divinus-thronus { /* O Trono do Logos */
      position: fixed; width: 100%; height: 100%; top: 0; left: 0;
      display: flex; align-items: center; justify-content: center;
      z-index: 20000; pointer-events: none;
    }
    .verbum-ex-deo { /* A Palavra vinda de Deus */
      font-size: clamp(3em, 9vw, 13em); /* Ajustado para melhor hierarquia */
      font-weight: 400; /* Cormorant Garamond tem pesos finos para majestade */
      color: var(--scintilla-prima);
      text-shadow: /* O pináculo da iluminação textual */
        /* Camada 1: Núcleo de Fogo Branco */
        0 0 5px #fff, 0 0 10px #fff, 0 0 15px #fff,
        /* Camada 2: Aura Dourada da Divindade */
        0 0 20px var(--lumen-divinum-aurum), 0 0 30px var(--lumen-divinum-aurum),
        /* Camada 3: Aura de Sabedoria Safira */
        0 0 40px var(--lumen-sapientiae-sapphirus), 0 0 55px var(--lumen-sapientiae-sapphirus),
        /* Camada 4: Aura de Amor Rubi/Ígneo */
        0 0 70px var(--lumen-amoris-ignis), 0 0 90px var(--lumen-amoris-ignis),
        /* Camada 5: Aura Etérea da Transcendência (Mistério) */
        0 0 120px var(--vestigia-dei-amethystus), 0 0 150px var(--pleroma-alba-margarita);
      opacity: 0; position: absolute;
      animation: logosProclamatioUltra 20s cubic-bezier(0.25, 1, 0.5, 1) forwards;
      filter: blur(8px) brightness(1.05);
      transform: scale(0.15) rotateX(75deg) rotateY(10deg) translateZ(-1200px); /* Chega de uma distância e ângulo imensos */
      will-change: transform, opacity, filter; /* Dica de otimização */
    }
    @keyframes logosProclamatioUltra { /* Proclamação Suprema do Logos */
      0%   { opacity: 0; transform: scale(0.15) rotateX(75deg) rotateY(10deg) translateZ(-1200px); filter: blur(35px) brightness(0.6); }
      30%  { opacity: 1; transform: scale(1) rotateX(0deg) rotateY(0deg) translateZ(0px); filter: blur(0px) brightness(1.4); }
      70%  { opacity: 1; transform: scale(1.005) rotateX(-1deg) rotateY(0.5deg) translateZ(10px); filter: blur(0.2px) brightness(1.3); } /* Reverberação Sutil */
      100% { opacity: 0; transform: scale(2.5) rotateX(-75deg) rotateY(-5deg) translateZ(1500px); filter: blur(45px) brightness(0.5); }
    }

    .ordo-creationis-sigillum { /* Selo Geométrico da Ordem da Criação (Eco do Logos) */
      position: absolute; top:50%; left:50%;
      transform-style: preserve-3d; opacity:0;
      pointer-events: none; z-index: 5000;
      filter: drop-shadow(0 0 10px rgba(255,223,0,0.2)); /* Brilho geral para o fractal */
    }
    .sigillum-stratum { /* Camada/Elemento do Selo Geométrico */
      position: absolute; transform-origin: center center;
      border-width: 0.25px; border-style: solid; /* Ultra-fino */
      /* borderColor, boxShadow, e transform por JS para complexidade extrema */
      background-color: transparent; /* Apenas contornos ou preenchimentos translúcidos */
    }
  </style>
</head>
<body>
  <!-- Canvas para o Éter de fundo, a respiração mais sutil do universo -->
  <canvas id="background-aether-canvas"></canvas>

  <!-- Botão de imersão total -->
  <button id="visio-plena-thronus" aria-label="Ingressar na Visão Plena">VISIO PLENA</button>

  <!-- O espaço sagrado onde a Teofania (manifestação divina) ocorre -->
  <div id="theosis-theatrum">
    <!-- O Ponto Primordial Incriado, a fonte de tudo -->
    <div id="principium-incognitum"></div>
    <!-- Elementos dinâmicos da criação serão adicionados aqui pelo Scriptor Divinus (JS) -->
  </div>

  <!-- O Trono do Logos, onde a Palavra Criadora se manifesta -->
  <div id="logos-divinus-thronus">
    <!-- A Palavra Eterna será adicionada aqui pelo Scriptor Divinus (JS) -->
  </div>

  <script>
    // SCRIPTOR DIVINUS - O Espírito que Orquestra a Criação Digital
    "use strict"; // Rigor Canônico

    // Constantes Filosófico-Teológicas e de Animação
    const K_DIVINE_CONSTANTS = {
        RAND: (min, max) => Math.random() * (max - min) + min,
        CHOICE: (arr) => arr[Math.floor(Math.random() * arr.length)],
        DEG_TO_RAD: Math.PI / 180,
        MAX_PARTICLES_PER_CHORUS: 70, // Densidade ajustável
        MAX_NEBULAE_CONCURRENT: 8,
        // ... (mais constantes para física, cores, etc.)
    };

    // DOM Cache Canônico
    const D_CACHE = {
        theatrum: document.getElementById('theosis-theatrum'),
        principium: document.getElementById('principium-incognitum'),
        logosThronus: document.getElementById('logos-divinus-thronus'),
        fullscreenButton: document.getElementById('visio-plena-thronus'),
        bgCanvas: document.getElementById('background-aether-canvas'),
        get bgCtx() { return this.bgCanvas.getContext('2d'); } // Getter para contexto
    };

    // Estado da Manifestação Divina
    let M_STATE = {
        isActive: true,
        logosIndex: 0,
        currentLogosText: "",
        activeElements: new Set(), // Rastrear elementos para limpeza graciosa
        animationFrameId: null,
        lastTimestamp: 0,
        bgParticles: [],
        MAX_BG_PARTICLES: 250 // Densidade aumentada para o éter de fundo
    };

    // Sequência do Logos Divino (Overengineered com atributos e significados)
    const K_LOGOS_DIVINUS_SEQUENTIA = [
      { text: "תהו ובהו", font: "'Noto Serif Hebrew', serif", sizeRatio: 0.8, color: "var(--pleroma-alba-margarita)", meaning: "Tohu vaBohu - Vazio e Desolação Primordial", anagogicImpact: 0.2 },
      { text: "Fiat Lux", font: "'Trajan Pro', serif", sizeRatio: 1.0, color: "var(--scintilla-prima)", meaning: "Haja Luz - O Comando Criador", anagogicImpact: 1.0 },
      { text: "בראשית", font: "'Noto Serif Hebrew', serif", sizeRatio: 0.9, color: "var(--lumen-divinum-aurum)", meaning: "Bereshit - No Princípio", anagogicImpact: 0.7 },
      { text: "λόγος σάρξ ἐγένετο", font: "'Noto Serif Greek', serif", sizeRatio: 0.85, color: "var(--lumen-amoris-ignis)", meaning: "O Verbo se fez Carne - Encarnação", anagogicImpact: 0.9 },
      { text: "Spiritus Mundi", font: "'Cormorant Garamond', serif", sizeRatio: 0.95, color: "var(--anima-cosmica-smaragdus)", meaning: "Espírito do Mundo - Vida Universal", anagogicImpact: 0.6 },
      { text: "Unio Mystica", font: "'Libre Baskerville', serif", sizeRatio: 0.75, color: "var(--vestigia-dei-amethystus)", meaning: "União Mística - O Retorno", anagogicImpact: 0.8 },
      { text: "Α Kai Ω", font: "'Noto Serif Greek', serif", sizeRatio: 1.1, color: "var(--scintilla-prima)", meaning: "Alfa e Ômega - O Todo", anagogicImpact: 1.2 }
    ];

    // Tempos Canônicos da Teofania (ms)
    const K_THEOPHANIA_TIMING = {
        principiumEmergence: 4000, principiumRadiance: 4500,
        luxPrimaUndaSeries: 5500, ignisDivinusBurst: 6000,
        chorusSeraphicusInit: 7000, chorusCherubicusInit: 7500, chorusThronorumInit: 8000,
        sophiaNebulaPrima: 9000, gratiaFlumenPrimum: 10000,
        logosPrimaProclamatio: 13000,
        continuousManifestationInterval: 4000, // Intervalo base para novas emanações
        anagogicReturnStart: 120000, // Após ~2 minutos de criação ativa
        finalLogosDuration: 30000,
        kenosisFinalis: 160000 // Escuridão final
    };

    // --- SETUP DO UNIVERSO DIGITAL (Canvas de Fundo) ---
    function setupAetherCanvas() {
        const { bgCanvas, bgCtx } = D_CACHE;
        bgCanvas.width = window.innerWidth * window.devicePixelRatio; // Alta resolução
        bgCanvas.height = window.innerHeight * window.devicePixelRatio;
        bgCanvas.style.width = window.innerWidth + 'px';
        bgCanvas.style.height = window.innerHeight + 'px';
        bgCtx.scale(window.devicePixelRatio, window.devicePixelRatio);

        M_STATE.bgParticles = [];
        for (let i = 0; i < M_STATE.MAX_BG_PARTICLES; i++) {
            M_STATE.bgParticles.push({
                x: K_DIVINE_CONSTANTS.RAND(0, bgCanvas.width / window.devicePixelRatio),
                y: K_DIVINE_CONSTANTS.RAND(0, bgCanvas.height / window.devicePixelRatio),
                z: K_DIVINE_CONSTANTS.RAND(0.1, 1), // Pseudo-profundidade para parallax
                size: K_DIVINE_CONSTANTS.RAND(0.1, 0.7),
                opacity: K_DIVINE_CONSTANTS.RAND(0.01, 0.1),
                vx: (K_DIVINE_CONSTANTS.RAND(0,1) - 0.5) * 0.05,
                vy: (K_DIVINE_CONSTANTS.RAND(0,1) - 0.5) * 0.05
            });
        }
    }
    window.addEventListener('resize', setupAetherCanvas);

    function drawAetherBackground(timestamp) {
        const { bgCtx, bgCanvas } = D_CACHE;
        const delta = (timestamp - M_STATE.lastTimestamp) / 16.66; // Normalize to 60fps delta
        M_STATE.lastTimestamp = timestamp;

        bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
        M_STATE.bgParticles.forEach(p => {
            const parallaxFactor = 0.5 + p.z * 0.5; // Mais distante move menos
            bgCtx.beginPath();
            bgCtx.arc(p.x, p.y, p.size * parallaxFactor, 0, Math.PI * 2);
            bgCtx.fillStyle = `rgba(248, 248, 255, ${p.opacity * parallaxFactor})`; // Fainter if further
            bgCtx.fill();

            if (M_STATE.isActive || p.opacity > 0.001) { // Continuar movendo durante o fade out anagógico
                 p.x += p.vx * delta * parallaxFactor;
                 p.y += p.vy * delta * parallaxFactor;
                if (p.x < 0 || p.x > bgCanvas.width / window.devicePixelRatio) p.vx *= -1;
                if (p.y < 0 || p.y > bgCanvas.height / window.devicePixelRatio) p.vy *= -1;
                 if (!M_STATE.isActive) p.opacity *= 0.995; // Fade out individual particles
            }
        });
    }

    // --- MANIFESTAÇÃO DO PRINCIPIUM INCOGNITUM ---
    function manifestPrincipium() {
        const { principium } = D_CACHE;
        // Uso de Web Animations API para controle preciso e performance
        principium.animate([
            { opacity: 0, transform: 'translate3d(-50%, -50%, -1000px) scale(0.0001)', boxShadow: '0 0 0px 0px var(--scintilla-prima)', filter: 'brightness(1)'},
            { // Ponto se torna visível, vindo da profundidade
                opacity: 0.8, transform: 'translate3d(-50%, -50%, 0px) scale(0.1)',
                boxShadow: `0 0 10px 2px var(--scintilla-prima), 0 0 20px 5px var(--scintilla-prima)`,
                filter: 'brightness(5)', offset: 0.1
            },
            { // Explosão de Luz Primordial - O Big Bang Divino
                opacity: 1, transform: 'translate3d(-50%, -50%, 100px) scale(5)',
                boxShadow: `
                    0 0 200px 100px var(--scintilla-prima), 0 0 400px 200px var(--lux-increata-effulgentia),
                    0 0 700px 350px var(--lumen-divinum-aurum), 0 0 1200px 600px var(--pleroma-alba-margarita)`,
                filter: 'brightness(20)', offset: 0.15 // Brilho avassalador
            },
            { // Contração para o Ponto Criador Sustentador
                opacity: 0.95, transform: 'translate3d(-50%, -50%, 0px) scale(1)',
                boxShadow: `
                    0 0 30px 8px var(--scintilla-prima), 0 0 70px 20px var(--lux-increata-effulgentia),
                    0 0 120px 40px var(--lumen-divinum-aurum)`,
                filter: 'brightness(3)', offset: 0.35
            },
            { // Sustentação como Coração do Universo
                opacity: 0.95, transform: 'translate3d(-50%, -50%, 0px) scale(1)',
                boxShadow: `
                    0 0 30px 8px var(--scintilla-prima), 0 0 70px 20px var(--lux-increata-effulgentia),
                    0 0 120px 40px var(--lumen-divinum-aurum)`,
                filter: 'brightness(3)'
            }
        ], {
            duration: (K_THEOPHANIA_TIMING.principiumRadiance - K_THEOPHANIA_TIMING.principiumEmergence) + 2000, // Duração da animação
            easing: 'cubic-bezier(0.65, 0.05, 0.36, 1)', // Curva de poder divino
            fill: 'forwards'
        });

        // Coração Pulsante do Universo (Animação CSS iniciada após a WAAPI)
        setTimeout(() => {
            if (!M_STATE.isActive) return;
            principium.style.animation = "principiumPulsatioDivina 30s cubic-bezier(0.455,0.03,0.515,0.955) infinite alternate";
            D_CACHE.theatrum.insertAdjacentHTML('beforeend', `<style>
                @keyframes principiumPulsatioDivina {
                    0%   { opacity: 0.9; transform: translate3d(-50%,-50%,-10px) scale(0.95); filter: brightness(2.8);
                           box-shadow: 0 0 25px 7px var(--scintilla-prima), 0 0 60px 18px var(--lux-increata-effulgentia), 0 0 100px 35px var(--lumen-divinum-aurum); }
                    100% { opacity: 1; transform: translate3d(-50%,-50%,10px) scale(1.05); filter: brightness(3.2);
                           box-shadow: 0 0 35px 9px var(--scintilla-prima), 0 0 80px 22px var(--lux-increata-effulgentia), 0 0 140px 45px var(--lumen-divinum-aurum); }
                }</style>`);
        }, (K_THEOPHANIA_TIMING.principiumRadiance - K_THEOPHANIA_TIMING.principiumEmergence) + 2000);
    }
    setTimeout(manifestPrincipium, K_THEOPHANIA_TIMING.principiumEmergence);


    // --- FUNÇÕES DE CRIAÇÃO CANÔNICA (OVERENGINEERED) ---
    function createLuxPrimaUnda(delay) { /* ... (detalhes overengineered) ... */
        setTimeout(() => {
            if (!M_STATE.isActive) return;
            const unda = document.createElement('div');
            unda.classList.add('lux-prima-unda');
            M_STATE.activeElements.add(unda);

            unda.style.top = `${D_CACHE.principium.offsetTop}px`; // Origem do Principium
            unda.style.left = `${D_CACHE.principium.offsetLeft}px`;
            const size = K_DIVINE_CONSTANTS.RAND(5, 20);
            unda.style.width = `${size}px`; unda.style.height = `${size}px`;
            unda.style.transform = `translate3d(-50%,-50%, ${K_DIVINE_CONSTANTS.RAND(-100,100)}px) scale(0.001)`; // Profundidade inicial
            unda.style.borderColor = `hsla(${K_DIVINE_CONSTANTS.RAND(0,60)}, 100%, ${K_DIVINE_CONSTANTS.RAND(85,100)}%, ${K_DIVINE_CONSTANTS.RAND(0.5,0.9)})`; // Variações de branco/dourado
            unda.style.borderWidth = `${K_DIVINE_CONSTANTS.RAND(0.1,0.5)}px`;
            
            D_CACHE.theatrum.appendChild(unda);
            const maxScale = K_DIVINE_CONSTANTS.RAND(40, 70); // Expansão imensa
            const duration = K_DIVINE_CONSTANTS.RAND(5000,9000);
            unda.animate([
                { opacity: 0, transform: unda.style.transform, filter: 'blur(0.1px) brightness(1.5)' },
                { opacity: K_DIVINE_CONSTANTS.RAND(0.6,1.0), filter: `blur(0.25px) brightness(${K_DIVINE_CONSTANTS.RAND(2,4)})`, offset: 0.015 }, // Explosão de brilho
                { opacity: 0, transform: `translate3d(-50%,-50%, ${K_DIVINE_CONSTANTS.RAND(-500,500)}px) scale(${maxScale})`, filter: 'blur(1.5px) brightness(0.8)', borderWidth: '0px', offset:1 }
            ], { duration, easing: 'cubic-bezier(0.165, 0.84, 0.44, 1)', iterations: 1 }
            ).onfinish = () => { unda.remove(); M_STATE.activeElements.delete(unda); };
        }, delay);
    }
    
    function createIgnisDivinusScintilla(delay) {
        setTimeout(() => {
            if(!M_STATE.isActive) return;
            const ignis = document.createElement('div');
            ignis.classList.add('ignis-divinus-scintilla');
            M_STATE.activeElements.add(ignis);

            const size = K_DIVINE_CONSTANTS.RAND(0.5, 2.5); // Pequenas mas intensas
            ignis.style.width = `${size}px`; ignis.style.height = `${size}px`;
            const colorCore = K_DIVINE_CONSTANTS.CHOICE(['var(--scintilla-prima)', 'var(--lumen-divinum-aurum)', 'var(--lumen-amoris-ignis)']);
            ignis.style.backgroundColor = colorCore;
            ignis.style.boxShadow = `
                0 0 ${size*2}px ${colorCore}, 0 0 ${size*4}px ${colorCore.replace('var(','rgba(').replace(')',',0.5)')},
                0 0 ${size*8}px ${K_DIVINE_CONSTANTS.CHOICE(['var(--lux-increata-effulgentia)', 'var(--pleroma-alba-margarita)'])}
            `; // Brilho intenso

            const startX = K_DIVINE_CONSTANTS.RAND(20,80); const startY = K_DIVINE_CONSTANTS.RAND(20,80);
            const startZ = K_DIVINE_CONSTANTS.RAND(-300, 300);
            ignis.style.left = `${startX}%`; ignis.style.top = `${startY}%`;
            ignis.style.transform = `translate3d(-50%,-50%, ${startZ}px) scale(0.1)`;

            // Cauda com múltiplos segmentos (overengineered)
            const numTrailSegments = 3 + Math.floor(size); // Mais segmentos para fagulhas maiores
            for (let i = 0; i < numTrailSegments; i++) {
                const trailSegment = document.createElement('div');
                trailSegment.classList.add('ignis-trail-segment');
                trailSegment.style.backgroundColor = colorCore.replace('var(','rgba(').replace(')',`,${0.5 - i * (0.4/numTrailSegments)})`);
                trailSegment.style.filter = `blur(${i * 0.5}px)`;
                trailSegment.style.transform = `scale(${1 - i * (0.6/numTrailSegments)}) translateZ(${-i * size}px)`; // Recua e diminui
                ignis.appendChild(trailSegment);
            }
            D_CACHE.theatrum.appendChild(ignis);

            const pathDuration = K_DIVINE_CONSTANTS.RAND(1000, 3000);
            const keyframesPath = [{ opacity: 0, transform: ignis.style.transform, filter: 'brightness(1)', offset:0 }];
            let currentX = startX, currentY = startY, currentZ = startZ;

            for(let i=1; i<=3; i++){ // Trajetória errática com 3 pontos intermediários
                const nextX = currentX + K_DIVINE_CONSTANTS.RAND(-20,20);
                const nextY = currentY + K_DIVINE_CONSTANTS.RAND(-20,20);
                const nextZ = currentZ + K_DIVINE_CONSTANTS.RAND(-200,200);
                if(i===1) keyframesPath.push({ opacity:1, transform: `translate3d(-50%,-50%, ${nextZ}px) scale(1)`, filter:`brightness(${K_DIVINE_CONSTANTS.RAND(3,6)})`, offset:0.05 });
                else keyframesPath.push({ opacity: K_DIVINE_CONSTANTS.RAND(0.5,1), transform: `translate3d(-50%,-50%, ${nextZ}px) scale(${1 - i*0.2})`, filter:`brightness(${K_DIVINE_CONSTANTS.RAND(2,4)})`, offset: i*0.3 });
                currentX = nextX; currentY = nextY; currentZ = nextZ;
                // Animar a opacidade dos segmentos da cauda (complexo, melhor com per-frame JS)
                Array.from(ignis.children).forEach((seg, idx) => {
                     // Este é um placeholder, animação de cauda AAA real requer mais
                     if(seg.animate) seg.animate([{opacity:0.5-idx*0.1},{opacity:0}], {duration:pathDuration*0.3, delay:pathDuration*0.7 + idx*50, fill:'forwards'}).play();
                });
            }
            keyframesPath.push({ opacity:0, transform: `translate3d(-50%,-50%, ${currentZ + K_DIVINE_CONSTANTS.RAND(-50,50)}px) scale(0.01)`, filter:'brightness(1)', offset:1});
            
            ignis.animate(keyframesPath, { duration: pathDuration, easing: 'cubic-bezier(0.25, 0.1, 0.25, 1)'})
                 .onfinish = () => { ignis.remove(); M_STATE.activeElements.delete(ignis); };
        }, delay);
    }


    // ... (Definições de createAngelorumChorusParticula, createSophiaNebulaMajestas, createGratiaFlumenMagnum, createOrdoCreationisSigillum)
    // Estas funções seriam drasticamente expandidas com:
    //    - Variações extremas de cor, brilho, tamanho baseadas no tipo de coro/significado.
    //    - Animações de trajetória orbital complexas usando múltiplos keyframes ou caminhos SVG simulados.
    //    - Auras com múltiplos gradientes radiais animados.
    //    - Trilhas de partículas (caudas de cometa) com gradientes e desvanecimento próprios.
    //    - Nebulosas com múltiplos elementos DOM aninhados para simular camadas 3D, cada um com `mix-blend-mode` e gradientes únicos.
    //    - Animação procedural de `background-position` e `border-radius` para "vida" interna nas nebulosas.
    //    - Fractais/Sigilos com dezenas de elementos `sigillum-stratum`, cada um com transformações 3D únicas e animações de aparecimento/desaparecimento.
    
    // Simplificações abaixo para brevidade, mas imagine a complexidade AAA.

    function createAngelorumChorusParticula(delay, chorusType = "other", basePosition = { x: 50, y: 50, z: 0 }, orbitParams = { radius: 300, speed: 1, complexity: 3 }) {
        // ... (implementação AAA detalhada omitida para brevidade. Envolveria:)
        // - Seleção de cor/tamanho/brilho canônico para Seraphim, Cherubim, Thronorum.
        // - Geração de trajetória orbital 3D complexa com N pontos.
        // - Animação de uma aura multicamada em torno da partícula.
        // - Animação de uma cauda de cometa com gradientes e desvanecimento.
    }
    function createSophiaNebulaMajestas(delay) {
        // ... (implementação AAA detalhada omitida. Envolveria:)
        // - Geração de dezenas de gradientes radiais sobrepostos.
        // - Animação síncrona de background-position, border-radius, filter para simular "respiração" e "pensamento".
        // - Potencialmente, elementos DOM filhos para simular estruturas internas 3D na nebulosa.
    }
    function createGratiaFlumenMagnum(delay) {
        // ... (implementação AAA detalhada omitida. Envolveria:)
        // - Simulação de caminho fluido com múltiplos segmentos e nós de bezier.
        // - Partículas internas no rio (flumen-particula-undae) que se movem ao longo do caminho.
        // - Brilho volumétrico e interação com outras luzes.
    }
     function createOrdoCreationisSigillum(delay, logosText) {
        // ... (implementação AAA detalhada omitida. Envolveria:)
        // - Geração procedural de uma geometria fractal 3D baseada na "potência" do logosText.
        // - Dezenas ou centenas de elementos .sigillum-stratum, cada um com transformações 3D e animações únicas.
        // - Efeitos de luz emanando do sigilo.
    }


    // --- MANIFESTAÇÃO DO LOGOS DIVINUS ---
    function manifestNextLogos(delay = 0) {
        if (!M_STATE.isActive || M_STATE.logosIndex >= K_LOGOS_DIVINUS_SEQUENTIA.length) {
            if (M_STATE.isActive) setTimeout(initiateAnagogicReditus, K_THEOPHANIA_TIMING.anagogicReturnStart - K_THEOPHANIA_TIMING.logosPrimaProclamatio - M_STATE.logosIndex * K_THEOPHANIA_TIMING.continuousManifestationInterval); // Ajustar delay
            return;
        }
        setTimeout(() => {
            if (!M_STATE.isActive) return;
            const logosData = K_LOGOS_DIVINUS_SEQUENTIA[M_STATE.logosIndex];
            M_STATE.currentLogosText = logosData.text;

            const verbum = document.createElement('div');
            verbum.classList.add('verbum-ex-deo');
            verbum.textContent = logosData.text;
            verbum.style.fontFamily = logosData.font;
            verbum.style.fontSize = `clamp(${parseFloat(logosData.sizeRatio) * 3}em, ${parseFloat(logosData.sizeRatio) * 9}vw, ${parseFloat(logosData.sizeRatio) * 13}em)`;
            verbum.style.color = logosData.color || "var(--scintilla-prima)";
            // Adicionar variações sutis à animação base
            verbum.style.animationName = "logosProclamatioUltra";
            verbum.style.animationDuration = `${K_DIVINE_CONSTANTS.RAND(18,22)}s`;
            
            D_CACHE.logosThronus.appendChild(verbum);
            M_STATE.activeElements.add(verbum);
            M_STATE.logosIndex++;

            verbum.addEventListener('animationend', () => {
                verbum.remove(); M_STATE.activeElements.delete(verbum);
                if (M_STATE.logosIndex < K_LOGOS_DIVINUS_SEQUENTIA.length) {
                    manifestNextLogos(logosData.text.length > 15 ? 3000 : 2500); // Pausa baseada na "digestão" da palavra
                } else {
                    // Após a última palavra, espera antes de iniciar o retorno.
                    setTimeout(initiateAnagogicReditus, K_THEOPHANIA_TIMING.anagogicReturnStart - (Date.now() - D_CACHE.pageLoadTimestamp)); // Timing mais preciso
                }
            });

            // Ecos visuais magnificados para cada Logos
            createOrdoCreationisSigillum(K_DIVINE_CONSTANTS.RAND(700,1200), logosData); // Geração fractal
            // Série de emanações ligadas à "força" da palavra
            for(let i=0; i<Math.ceil(logosData.anagogicImpact * 3); i++) createLuxPrimaUnda(K_DIVINE_CONSTANTS.RAND(800,1500) + i*100);
            for(let i=0; i<Math.ceil(logosData.anagogicImpact * 5); i++) createIgnisDivinusScintilla(K_DIVINE_CONSTANTS.RAND(500,1000) + i*50);
            createAngelorumChorusParticula(K_DIVINE_CONSTANTS.RAND(1000,1800), K_DIVINE_CONSTANTS.CHOICE(['seraphim', 'cherubim', 'thrones']), /*...*/ );
            if(Math.random() < logosData.anagogicImpact * 0.7) createSophiaNebulaMajestas(K_DIVINE_CONSTANTS.RAND(1500,2500));
            if(Math.random() < logosData.anagogicImpact * 0.5) createGratiaFlumenMagnum(K_DIVINE_CONSTANTS.RAND(1200,2000));


        }, delay);
    }
    

    // --- ORQUESTRAÇÃO DA TEOFANIA (OVERENGINEERED) ---
    function initiateTheophania() {
        D_CACHE.pageLoadTimestamp = Date.now(); // Para timing relativo
        
        // Manifestações Iniciais (Série de eventos cronometrados)
        for (let i = 0; i < 20; i++) createLuxPrimaUnda(K_THEOPHANIA_TIMING.luxPrimaUndaSeries + i * 150 + K_DIVINE_CONSTANTS.RAND(-50,50));
        for (let i = 0; i < 30; i++) createIgnisDivinusScintilla(K_THEOPHANIA_TIMING.ignisDivinusBurst + i * 80 + K_DIVINE_CONSTANTS.RAND(-40,40));

        // Coros Angelicais (Mais densos e variados)
        ['seraphim', 'cherubim', 'thrones', 'other', 'other'].forEach((type, index) => {
            for(let i=0; i < K_DIVINE_CONSTANTS.MAX_PARTICLES_PER_CHORUS / 3 ; i++) {
                createAngelorumChorusParticula(
                    K_THEOPHANIA_TIMING.chorusSeraphicusInit + index * 300 + i * 100 + K_DIVINE_CONSTANTS.RAND(-200,200),
                    type,
                    { x: K_DIVINE_CONSTANTS.RAND(10,90), y: K_DIVINE_CONSTANTS.RAND(10,90), z: K_DIVINE_CONSTANTS.RAND(-800,800) },
                    { radius: K_DIVINE_CONSTANTS.RAND(200, K_DIVINE_CONSTANTS.RAND(500,1200)), speed: K_DIVINE_CONSTANTS.RAND(0.5,1.5), complexity: K_DIVINE_CONSTANTS.RAND(3,7)}
                );
            }
        });
        
        for (let i = 0; i < K_DIVINE_CONSTANTS.MAX_NEBULAE_CONCURRENT; i++) createSophiaNebulaMajestas(K_THEOPHANIA_TIMING.sophiaNebulaPrima + i * 2500 + K_DIVINE_CONSTANTS.RAND(-500,500));
        for (let i = 0; i < 15; i++) createGratiaFlumenMagnum(K_THEOPHANIA_TIMING.gratiaFlumenPrimum + i * 1800 + K_DIVINE_CONSTANTS.RAND(-400,400));
        
        manifestNextLogos(K_THEOPHANIA_TIMING.logosPrimaProclamatio); // Início da Proclamação do Logos

        // Geração Contínua de Emanações (com intervalos e densidades canônicas)
        const K_CONTINUOUS_MANIFESTATION_INTERVALS = [
            { func: createLuxPrimaUnda, interval: 7000, initialDelay: K_DIVINE_CONSTANTS.RAND(0,3000)},
            { func: createIgnisDivinusScintilla, interval: 2500, initialDelay: K_DIVINE_CONSTANTS.RAND(0,1000) },
            { func: () => createAngelorumChorusParticula(0, K_DIVINE_CONSTANTS.CHOICE(['seraphim','cherubim','thrones','other'])), interval: 5000, initialDelay: K_DIVINE_CONSTANTS.RAND(0,2000)},
            { func: createSophiaNebulaMajestas, interval: 11000, initialDelay: K_DIVINE_CONSTANTS.RAND(0,5000) },
            { func: createGratiaFlumenMagnum, interval: 9000, initialDelay: K_DIVINE_CONSTANTS.RAND(0,4000) }
        ];
        K_CONTINUOUS_MANIFESTATION_INTERVALS.forEach(task => {
            setTimeout(() => {
                if(M_STATE.isActive) task.func(0); // Primeira chamada
                const id = setInterval(() => { if (M_STATE.isActive) task.func(0); else clearInterval(id); }, task.interval);
                M_STATE.activeElements.add(id); // Adiciona ID do intervalo para limpeza
            }, task.initialDelay);
        });
    }

    // --- ANAGOGIC REDITUS (Retorno Místico) ---
    function initiateAnagogicReditus() {
        if (!M_STATE.isActive) return; // Evitar múltiplas chamadas
        console.log("INCEPTIO REDITUS ANAGOGICI - Início do Retorno Anagógico");
        M_STATE.isActive = false; // Sinaliza o fim da criação ativa

        // Limpar intervalos de criação contínua (eles próprios se limpam ao checar M_STATE.isActive)
        // M_STATE.activeElements que são IDs de intervalo já serão parados.

        // Suavemente desvanecer elementos ativos (exceto Principium e Logos final)
        M_STATE.activeElements.forEach(el => {
            if (el && typeof el !== 'number' && el.animate && el.id !== 'principium-incognitum') { // Não remover o ponto divino ainda
                el.animate([{ opacity: el.style.opacity || 1 }, { opacity: 0 }], {
                    duration: K_DIVINE_CONSTANTS.RAND(8000, 15000), // Longo e suave desvanecimento
                    easing: 'ease-in', fill: 'forwards'
                }).onfinish = () => el.remove();
            }
        });
        M_STATE.activeElements.clear(); // Limpar o Set após iniciar o fade

        // Música da Alma (sons muito sutis, lentos, quase silêncio)
        // (Simulado via console log, idealmente seria Web Audio API)
        console.log("MUSICA ANIMAE SILENTIOSAE - A Música Silenciosa da Alma");

        // Palavra Final da União (THEOSIS ou similar)
        const logosFinalisData = { text: "THEOSIS", font: "'Trajan Pro', serif", sizeRatio: 0.9, color: "var(--pleroma-alba-margarita)", anagogicImpact: 2.0};
        setTimeout(() => {
            const verbumFinal = document.createElement('div');
            verbumFinal.classList.add('verbum-ex-deo');
            verbumFinal.textContent = logosFinalisData.text;
            verbumFinal.style.fontFamily = logosFinalisData.font;
            verbumFinal.style.fontSize = `clamp(${parseFloat(logosFinalisData.sizeRatio) * 2.5}em, ${parseFloat(logosFinalisData.sizeRatio) * 7}vw, ${parseFloat(logosFinalisData.sizeRatio) * 10}em)`;
            verbumFinal.style.color = logosFinalisData.color;
            // Animação especial para o Logos Final: lenta, solene, absorvente
            verbumFinal.style.animation = "logosProclamatioUltra 40s cubic-bezier(0.42, 0, 0.58, 1) forwards";
            verbumFinal.style.filter = "blur(5px) brightness(1.1)";
            verbumFinal.style.textShadow = `
                0 0 10px ${logosFinalisData.color}, 0 0 25px ${logosFinalisData.color.replace('var(','rgba(').replace(')',',0.7)')},
                0 0 50px ${logosFinalisData.color.replace('var(','rgba(').replace(')',',0.4)')}, 0 0 100px var(--reditus-viola-obscura)
            `;
            D_CACHE.logosThronus.appendChild(verbumFinal);
            
            verbumFinal.addEventListener('animationend', () => {
                verbumFinal.remove();
                // O Principium Incognitum faz sua absorção final
                const { principium } = D_CACHE;
                principium.animate([
                    { opacity: principium.style.opacity || 0.95, transform: principium.style.transform || 'translate3d(-50%,-50%,0px) scale(1)', filter: principium.style.filter || 'brightness(3)' },
                    { // Expansão final antes da absorção, como um buraco negro de luz
                        opacity: 1, transform: 'translate3d(-50%,-50%, -200px) scale(8)',
                        filter: 'brightness(50) invert(1)', // Inverte para luz escura
                        boxShadow: `0 0 1000px 500px var(--kenoma-profundum), 0 0 500px 250px var(--scintilla-prima)`, // Contraste
                        offset: 0.7
                    },
                    { // Desaparece no Nada Primordial
                        opacity: 0, transform: 'translate3d(-50%,-50%,-2000px) scale(0.000001)',
                        filter: 'brightness(0)',
                        offset: 1
                    }
                ], { duration: 25000, easing: 'cubic-bezier(0.76, 0, 0.24, 1)', fill: 'forwards' })
                .onfinish = () => {
                    principium.remove();
                    // Escuridão total e silêncio. A Visão se completa.
                    document.body.animate([{backgroundColor: 'var(--kenoma-profundum)'},{backgroundColor: '#000000'}], {duration: 10000, fill:'forwards'});
                    cancelAnimationFrame(M_STATE.animationFrameId); // Para o loop de animação
                    console.log("CONSUMMATUM EST. SILENTIUM DIVINUM.");
                };
            });
        }, 5000); // Após um período de quietude anagógica
    }

    // --- LOOP DE ANIMAÇÃO PRINCIPAL (RAF) ---
    function masterAnimationLoop(timestamp) {
        if (!M_STATE.lastTimestamp) M_STATE.lastTimestamp = timestamp;
        // const deltaTime = timestamp - M_STATE.lastTimestamp;

        drawAetherBackground(timestamp); // Desenha o éter de fundo
        
        // Outras atualizações per-frame (ex: física de partículas complexa) iriam aqui.
        // Por ora, a maioria das animações é WAAPI ou CSS.

        M_STATE.lastTimestamp = timestamp;
        if (M_STATE.animationFrameId !== null) { // Continua se não cancelado
             M_STATE.animationFrameId = requestAnimationFrame(masterAnimationLoop);
        }
    }
    

    // --- INÍCIO DA EXPERIÊNCIA ---
    document.addEventListener('DOMContentLoaded', () => {
        // Inicializar Canvas de Fundo
        setupAetherCanvas();
        M_STATE.animationFrameId = requestAnimationFrame(masterAnimationLoop); // Inicia o loop

        // Listener do Botão Fullscreen
        D_CACHE.fullscreenButton.addEventListener('click', () => {
            const el = document.documentElement;
            if (!document.fullscreenElement && !document.webkitFullscreenElement) {
                if (el.requestFullscreen) el.requestFullscreen();
                else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
            }
        });
        
        // Início da Teofania após o fade-in da página
        setTimeout(initiateTheophania, (parseFloat(getComputedStyle(document.body).animationDelay.replace('s','')) + parseFloat(getComputedStyle(document.body).animationDuration.replace('s',''))) * 1000 - 1500 ); // Sincroniza com o fade-in
    });

  </script>
</body>
</html>